!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n,o=e();for(n in o)("object"==typeof exports?exports:t)[n]=o[n]}}(self,()=>(()=>{"use strict";var t={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);const r={name:"blanknumber",text:"序号填空",icon:"blanknumber",tooltip:"序号填空"};function i({editor:t,data:e}){({editor:e,data:n}={editor:t,data:e}),o=e.dom.create("span",{contenteditable:!1,class:"xe-"+r.name,"data-name":r?.name},n?.content??"&nbsp;"),n&&e.dom.setAttrib(o,"data-content",JSON.stringify(n));var n,o,e=o;return t.dom.getOuterHTML(e)}function d({editor:n}){var t=n.selection.getBookmark(2,!0);const e=n.dom.create("div",null,n.getContent()),o=e.querySelectorAll(`[data-name="${r.name}"]`),a=Number(JSON.parse(n.dom.getAttrib(o[0],"data-content")||"{}")?.content??1);o.forEach((t,e)=>{e+=a;n.dom.setHTML(t,e),n.dom.setAttribs(t,{"data-content":JSON.stringify({content:String(e)})})}),n.setContent(e.innerHTML),n.selection.moveToBookmark(t),n.selection.setCursorLocation(n.selection.getNode().parentNode,n.selection.getRng()?.endOffset)}class c{constructor({editor:t}){this.editor=t}open({target:t}){const e=this["editor"];let n=null;t&&(t=e.dom.getAttrib(t,"data-content"))&&(n=JSON.parse(t)),e.windowManager.open({title:"序号",body:{type:"panel",items:[{type:"input",name:"content"}]},initialData:{content:n?.content??""},buttons:[{type:"cancel",name:"cancel",text:"取消"},{type:"submit",name:"ok",text:"确定",primary:!0}],onSubmit:t=>{e.execCommand("mceInsertContent",!1,i({editor:e,data:t.getData()})),d({editor:e}),t.close()}})}}return tinymce.PluginManager.add(r.name,function(t){function e(t){}function n(){o.execCommand("mceInsertContent",!1,i({editor:o})),d({editor:o})}var o,a;return o=[{editor:t}["editor"]][0],o.ui.registry.addToggleButton(r.name,{text:r.text,icon:r.icon,tooltip:r.tooltip,onAction:n,onSetup:e}),o.ui.registry.addToggleMenuItem(r.name,{text:r.text,icon:r.icon,onAction:n,onSetup:e}),a=[{editor:t}["editor"]][0],a.on("dblclick",t=>{t=a.dom.getParent(t.target,`[data-name="${r.name}"]`);const e=a.dom.create("div",null,a.getContent());var n=e.querySelectorAll(`[data-name="${r.name}"]`)[0];a.dom.getAttrib(t,"data-content")===a.dom.getAttrib(n,"data-content")&&new c({editor:a}).open({target:t})}),{getMetaData:()=>({name:r.name})}}),e})());